---
title: "Exploratory Analysis of U.S. Census Data in R"
excerpt: "Does scraping through the Census Bureau website database tire you? We will be walking through how to optimize the census bureau experience (and struggle) through the use of R and it's supported tidy packages. We will start off within the Maryland context and expand to other varied locations in the U.S.--either way, the data shall be replicable for all. <br/><img src='/images/portfolio_cover2.png'>"
collection: portfolio
---

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Celine Brundridge">

<title>U.S Census Data &amp; R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="lab2_quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab2_quarto_files/libs/quarto-html/quarto.js"></script>
<script src="lab2_quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="lab2_quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab2_quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab2_quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab2_quarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab2_quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab2_quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab2_quarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="lab2_quarto_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="lab2_quarto_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="lab2_quarto_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="lab2_quarto_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="lab2_quarto_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="lab2_quarto_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="lab2_quarto_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="lab2_quarto_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">U.S Census Data &amp; R</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Celine Brundridge </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Does scraping through the Census Bureau website database tire you? We will be walking through how to optimize the census bureau experience (and struggle) through the use of R and it’s supported tidy packages. We will start off within the Maryland context and expand to other varied locations in the U.S.–either way, the data shall be replicable for all.</p>
<p><em>What worked well for you and what didn’t work?</em> - Everything worked out well for me, and I tested the replicability in the beginning by changing the code in the Maryland context, along with other modifications. I had to comment out a few lines of code that has errors on purpose, such as the Oglala Lakota county name change in the <strong>Time Series</strong> section.</p>
<p><em>What do you see as the value in using RQuarto?</em> - RQuarto was an extremely efficient way to combine code and their relative explanations in a seamless fashion to render on a consistent document for report generation! I also will say that I prefer working on the “Source” tab more than the “Visual” tab in the RQuarto interface, so I can see the code lines as well as note formatting and font changes in my writing.</p>
<p><em>Based on lab 2 so far, what things would you like to do?</em> - I would love to use the visualization functions to create plots quickly. I always wondered how folks made those interactive graphics that I saw on websites and such so seamlessly (for free!). I used to have to plug in data and create the plots manually on excel before–which was especially tedious for plots like the population pyramids.</p>
<p>This code and work is largely attributed to Kyle Walker’s <em>Analyzing US Census Data: Methods, Maps, and Models in R</em>, 2023.</p>
</section>
<section id="load-necessary-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-necessary-libraries">Load Necessary Libraries</h2>
<p>Installing and loading these packages are necessary for data optimization throughout the rest of the script. R packages can be installed by searching it up on the “Packages” tab of RStudio and installing. Then, by using the function “library”, the library of the package can be loaded into the script for use. Short descriptions of each package is detailed next to the corresponding script line below.</p>
<p>Next, we will have to set a Census Application Programming Interface (API) key with the <code>census_api_key()</code> function. API keys are unique to the user and can be obtained at <a href="https://api.census.gov/data/key_signup.html" class="uri">https://api.census.gov/data/key_signup.html</a>. After you’ve signed up for an API key and activated it from your email, you can begin working on Census Bureau data as if it were being plucked directly from the website.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install these packages below once</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("sf")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidycensus")</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tidyverse")</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("tigris")</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("magrittr")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggplot2")</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("scales")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("purrr")</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#load the libraries needed</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf) <span class="co">#simple features for R in handling geographic data</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidycensus) <span class="co">#using Kyle Walker's book, loads US census boundary and attribute data frames</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#collection of tidy packages for data structuring</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tigris) <span class="co">#utilized in erasing water</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr) <span class="co">#pipe operators for R, such as %&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co">#creating optimized data visualizations</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co">#scale functions for visualization</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr) <span class="co">#functional programming tools</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co">#census_api_key("492c835f63654b3b0b78a8674ac94e9411625187", install = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To conveniently save this key for future R session use, use the <code>install = TRUE</code> argument. With this initiated, you can comment (#) out the line if you were to run this code chunk multiple times on the same project.</p>
</section>
<section id="decennial-census-chapter-2" class="level2">
<h2 class="anchored" data-anchor-id="decennial-census-chapter-2">Decennial Census (Chapter 2)</h2>
<p>The Decennial Census is U.S. census counts for every resident in the United States that occur every 10 years, as mandated by Article I, Section 2 of the Constitution. <strong>tidycensus</strong> can access decennial Census data from the 2000, 2010, and 2020 decennial US Censuses and can retrieve whatever scale and type of data is needed. What makes this tool stand out versus just going on the Census website is that it comb out unecessary data from otherwise large datasets. On that note, we will utilize R to set specifications in order to retrieve the right data using the <code>get_decennial()</code> function.</p>
<p>These specifications include a string representing the requested <code>geography</code>, a vector of Census variable IDs represented by <code>variable</code>, or optionally a Census table ID passed to <code>table</code>, and the <code>year</code> that you would like to examine. Note that when you specify a geography only, it will default to the extent of the United States, but each row will be split based on the geography chosen–so inputting state will output data for each state of the U.S., inputting county will output data for each county of the U.S., and so on–unless you narrow it down. The variable is the demographic characteristic that would like to be examined, such as population, housing, occupation, and other indicator within a table/topic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MDtotal_population_10 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"P001001"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2010</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2010 decennial Census</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using Census Summary File 1</code></pre>
</div>
</div>
<p>To narrow the <code>geography</code> down, in this example I added a line, <code>state</code> then input the state initials (You can use full state names, state initials/postal codes, and FIPS codes). It has resulted in an output table called <code>MDtotal_population_10</code>, showing total population data for each county in Maryland from the 2010 census. More geographical specifications can be subset further to pull data, for this example pulling counties for one state, so that you will not have to comb through all counties in the country (the largest geographic context).</p>
<p>The decennial census by default will pull the data from the Census Summary File 1 using the argument <code>sumfile = "sf1"</code>, containing core demographic characteristics for Census geographies. If you would like to retrieve information on a range of population and housing unit characteristics, use the Summary File 2 argument <code>sumfile = "sf2"</code>. If you would like to retrieve detailed demographic information such as income and occupation, use the Summary Files 3 (<code>"sf3"</code>) and 4 (<code>"sf4"</code>).</p>
<p>At the moment, the above agruments are only available for the 2000 and 2010 decennial census. For 2020, only the PL 94-171 Redistricting summary file data is available, using the argument <code>sumfile = "pl"</code>. Below, information is retrieved on the American Indian &amp; Alaska Native population (<code>variable</code>) by county (<code>geography</code>) in Maryland from the 2020 decennial census.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MDaian_2020 <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"P1_005N"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sumfile =</span> <span class="st">"pl"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2020 decennial Census</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the PL 94-171 Redistricting Data Summary File</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: 2020 decennial Census data use differential privacy, a technique that
introduces errors into data to preserve respondent confidentiality.
ℹ Small counts should be interpreted with caution.
ℹ See https://www.census.gov/library/fact-sheets/2021/protecting-the-confidentiality-of-the-2020-census-redistricting-data.html for additional guidance.
This message is displayed once per session.</code></pre>
</div>
</div>
<p>The Redistricting summary files include a limited subset of variables from the decennial US Census to be used for legislative redistricting. These variables include total population and housing units; race and ethnicity; voting-age population; and group quarters population.</p>
</section>
<section id="american-community-survey" class="level2">
<h2 class="anchored" data-anchor-id="american-community-survey">American Community Survey</h2>
<p>The American Community Survey (ACS) is a demographics survey program conducted by the U.S. Census Bureau, typically producing data annually (1 year ACS) or across a five-year span (5 year ACS). While there is no constitutional mandate, it is an extremely useful tool for noting changes taking place in communities across the nation. <strong>tidycensus</strong> can access American Community Survey data through the <code>get_acs() function</code>, each row similar to the retrieval methods of the Decennial Census. Without setting a parameter, the data defaults to the 5yr ACS, so if you would like to retrieve the 1-year ACS, use the <code>survey = "acs1"</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>MDborn_in_mexico <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B05006_150"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>MDborn_in_mexico_1yr <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B05006_150"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2019 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
</div>
<p>The ACS was able to retrieve specific information on the number of residents born in Mexico by county in Maryland (Born in mexico, but live in Maryland currently), something not as readily available on the Decennial Census. Note the new category on the table, called “moe”, or margin of error, which is at a 90 percent confidence level. The margin of error increases the larger the geographic scale, for both privacy and reliability.</p>
<p>However, when retrieving the 1 year ACS, there is no data (NA) in any columns except for Montgomery County. For states with smaller Mexican-born populations like Maryland, the estimate is too small for a given geography to be deemed reliable by the Census Bureau.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>MDwhole_born_in_mexico_1yr <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"state"</span>, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B05006_150"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2019 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
</div>
<p>In this case, only the states like Arizona, California, and Colorado with historically large mexican-born populations may have better current representation for that variable in the 1-year ACS, meaning that the 5-year ACS should be used to make full state-wise comparisons, as shown above with Maryland.</p>
<p>If you provide a table name instead of the variable, it broadens the amount of data shown for that topic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>age_table <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> <span class="st">"B01001"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading ACS5 variables for 2020 from table B01001. To cache this dataset for faster access to ACS tables in the future, run this function with `cache_table = TRUE`. You only need to do this once per ACS dataset.</code></pre>
</div>
</div>
<p>By replacing the <code>variables</code> with <code>table</code> will return data available for every variable in that table, per county, which is a lot more data!</p>
<p>While our data focus has been on the counties of Maryland, there are many geographies that can be requested, such as “state”, “county”, “county subdivision”, “tract”, “block group”, and “place”. For core-based statistical areas, “cbsa” can be used and for zip code tabulation areas, “zcta” can be used. Both of these areas tend to be heavily-requested geographies. The next few of code chunks are a couple of different geographic contexts and variables to show the multitude of data that can be pulled and analyzed with ACS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cbsa_population <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"cbsa"</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B01003_001"</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>I am in the Baltimore-Columbia-Towson, MD MSA (Maryland Statistical Area), but there are many core statistical areas that cross state and county boundaries. Due to the inconsistent boundaries, I cannot utilize the <code>state = "MD"</code> agrument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>md_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B19013_001"</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>balt_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"tract"</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B19013_001"</span>, </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>, </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Baltimore City"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>) <span class="co">#census tracts can be subsetted by county, as these geographies do not cross county boundaries.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>The 5-year ACS is able to provide reliable data for geographies down to the block group, while the 1-year ACS can only return data for geographies of population 65,000 and greater.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(md_income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>md_income_1yr <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B19013_001"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2019 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(md_income_1yr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
</div>
<p>When examining rows using the <code>nrow</code> function between 5 and 1 year ACS, there is a noticeable difference in row counts as some geographies like Census tracts will never be available in the 1-year ACS, and that other geographies such as the counties displayed above are only partially available.</p>
</section>
<section id="data-structure" class="level2">
<h2 class="anchored" data-anchor-id="data-structure">Data Structure</h2>
<p>The default setting in the get_acs() and get_decennial() functions are in the <code>output = "tidy"</code> when rows are returned, as is the nature of <strong>tidycensus</strong>–seperating them into <code>GEOID</code>, <code>NAME</code>, <code>variable</code>, and <code>value</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>MDhhinc <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> <span class="st">"B19001"</span>, </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2016</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading ACS1 variables for 2016 from table B19001. To cache this dataset for faster access to ACS tables in the future, run this function with `cache_table = TRUE`. You only need to do this once per ACS dataset.</code></pre>
</div>
</div>
<p>The alternative spread across many columns rather than across the standard four that we have seen thus far can be configured through the <code>output = "wide"</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>MDhhinc_wide <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> <span class="st">"B19001"</span>, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span>, </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2016</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"wide"</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading ACS1 variables for 2016 from table B19001. To cache this dataset for faster access to ACS tables in the future, run this function with `cache_table = TRUE`. You only need to do this once per ACS dataset.</code></pre>
</div>
</div>
<p>While the wide-form dataset still contains the GEOID and NAME columns, each variable is it’s own column, with an “E” at the end of the digits to signify it as the Estimate, while the “M” at the end of the digits to signify Margin of Error, as the ACS is.</p>
<p>Another component of data structure is the composition of the <code>GEOID</code>, which is a unique geographic identifier that interlinks the smallest unit to its parent unit/geography.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>balt_blocks <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"block"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"H1_001N"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Baltimore City"</span>,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sumfile =</span> <span class="st">"pl"</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2020 decennial Census</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the PL 94-171 Redistricting Data Summary File</code></pre>
</div>
</div>
<p>When the data frame is created, open it and note the long string of numbers in the <code>GEOID</code> (scaling from the state to the block) and the adjacent <code>NAME</code> is the reverse iteration of the <code>GEOID</code> sequence as characters. * The first two digits correspond to the Federal Information Processing Series (FIPS) code for the state. * Digits 3 through 5 are representative of County codes, usually displayed in conjuction with the FIPS codes. * The next six digits represent the block’s Census tract. The tract name in the NAME column is Census Tract (ex. 2708); the six-digit tract ID is right-padded with zeroes. * The twelfth digit represents the parent block group of the Census block. As there are no more than nine block groups in any Census tract, the block group name will not exceed 9. * The last three digits represent the individual Census block, though these digits are combined with the parent block group digit to form the block’s name.</p>
<p>Note that geographies outside the above core Census hierarchy will have GEOIDs with unique geographic units that only include IDs of parent geographies to the extent in which they nest within them. For example, a geography that nests within states but may cross county boundaries like school districts will include the state GEOID in its GEOID but unique digits after that. Geographies like core-based statistical areas that do not nest within states will have fully unique GEOIDs, independent of any other geographic level of aggregation such as states since they cross state boundaries as mentioned prior.</p>
</section>
<section id="variable-ids" class="level1">
<h1>Variable ID’s</h1>
<p>You may have gotten this far wondering “how are we supposed to know what variable numbers and codes to use without scouring across the Census Bureau website? Isn’t that counter-productive?”. This is where the <code>load_variables()</code> function comes in, as it obtains a dataset of variables from the Census Bureau website and formats it into the data tables that we have been examining thus far for fast searching.</p>
<p>Note that the <code>cache = TRUE</code> argument entails that knitr will skip the execution of this code chunk if it has been executed before and nothing in the code chunk has changed since then, since this table is very large and time-consuming to run (memoization).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>v16 <span class="ot">&lt;-</span> <span class="fu">load_variables</span>(<span class="dv">2016</span>, <span class="st">"acs5"</span>, <span class="at">cache =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(v16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>View()</code> function is RStudio’s interactive data viewer, with filter options for ideal browsing in a seperate pane. Note that this output data frame can also be filtered using tidyverse tools for variable exploration.</p>
<p>Furthermore, it is still a hassle attempting to remember the IDs for variables. Once you retrieve your variable numbers, <strong>tidycensus</strong> has the ability automatically rename the variable IDs if requested by a user. Below, we are requesting data on the variables median household income (variable ID B19013_001) and median age (variable ID B01002_001). In either the get_acs() or get_decennial() function, modify your <code>variables =</code> argument using <code>c()</code> to group and array both variables, assigning their IDs to the name “medinc” and “medage”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>md_med <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Maryland"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="at">medinc =</span> <span class="st">"B19013_001"</span>,</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">medage =</span> <span class="st">"B01002_001"</span>),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>The functions will now return the assigned names rather than the Census variable IDs in future use. Small data structuring adaptations like this one will increase the readability of your script!</p>
<p>Note that when a wide-form dataset is requested, <strong>tidycensus</strong> will still include E and M in the specified column names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mdmed_wide <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Maryland"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="at">medinc =</span> <span class="st">"B19013_001"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">medage =</span> <span class="st">"B01002_001"</span>),</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"wide"</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<section id="population-estimates-program" class="level2">
<h2 class="anchored" data-anchor-id="population-estimates-program">Population Estimates Program</h2>
<p>The Population Estimates Program (PEP) is a smaller database that provides yearly estimates of the US population and its components between decennial Census years, produced once the census at the end of the decade has been completed by projecting forward data from the most recent Census based on birth, death, and migration rates. Note that due to the different methodologies, estimates in the PEP will differ slightly from ACS data returns.</p>
<p>Using the <code>get_estimates()</code> function in <strong>tidycensus</strong>, you can specify indicators used to produce the intercensal population estimates. The products available include “population”, “components”, “housing”, and “characteristics”. Below, we can request all “components” of change population estimates for 2019 for Baltimore City.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>balt_components <span class="ot">&lt;-</span> <span class="fu">get_estimates</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">product =</span> <span class="st">"components"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Baltimore City"</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>product = "characteristics"</code> argument is another product, letting users get breakdowns of population estimates for the US, states, and counties by “AGEGROUP”, “RACE”, “SEX”, or “HISP” (Hispanic origin). The other addition is informative labels for the population estimates, activated by the <code>breakdown_labels = TRUE</code> argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>md_sex_hisp <span class="ot">&lt;-</span> <span class="fu">get_estimates</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">product =</span> <span class="st">"characteristics"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">breakdown =</span> <span class="fu">c</span>(<span class="st">"SEX"</span>, <span class="st">"HISP"</span>),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breakdown_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="acs-migration-flows-api" class="level2">
<h2 class="anchored" data-anchor-id="acs-migration-flows-api">ACS Migration Flows API</h2>
<p>Lastly, the ACS Migration Flows API is another small database off of the American Community Survey that returns information on both in- and out-migration for states, counties, and metropolitan areas–with specific analysis of in-migrants, emigrants, and net migration for a given geography in the 5-year ACS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>md_migration <span class="ot">&lt;-</span> <span class="fu">get_flows</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MD"</span>,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Baltimore City"</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="debugging" class="level2">
<h2 class="anchored" data-anchor-id="debugging">Debugging</h2>
<p>Errors are prone to occur, so to verify the data retrival, the argument <code>show_call = TRUE</code> prints out the actual API call that <strong>tidycensus</strong> is making to the Census API.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>cbsa_bachelors <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"cbsa"</span>,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"DP02_0068P"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span>,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_call =</span> <span class="cn">TRUE</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2015-2019 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Data Profile</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Census API call: https://api.census.gov/data/2019/acs/acs5/profile?get=DP02_0068PE%2CDP02_0068PM%2CNAME&amp;for=metropolitan%20statistical%20area%2Fmicropolitan%20statistical%20area%3A%2A</code></pre>
</div>
</div>
<p>This can help us understand the technicalities behind the R to Census API translation and understanding what data is available from the API, especially if functions are returning unwarranted NA in certain rows. If the raw API call itself contains missing values for given variables, this will confirm that the requested data are not available from the API at a given geography.</p>
</section>
<section id="tidyverse-chapter-3" class="level2">
<h2 class="anchored" data-anchor-id="tidyverse-chapter-3">Tidyverse (Chapter 3)</h2>
<p>The <strong>tidyverse</strong> is a collection of tidy packages for data structuring, import, tidying, manipulation, and visualization. Eight tidyverse packages are loaded: ggplot2, tibble, purrr, dplyr, readr, and tidyr are included along with stringr for string manipulation and forcats for working with factors. Below, data is being retrieved for median age by United States Counties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>median_age <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B01002_001"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>You may have also noticed throughout this process that the default method for printing data outputs on this document shows the first 10 rows of the dataset, starting with Alabama.</p>
<p>However, when exploring and analyzing data examining trends, extremes, and other clusterings are important. Below, the <code>arrange()</code> function sorts a dataset by values in one or more columns (dataset, column) and returns the sorted result in order to understand which counties are the youngest and oldest in the U.S. as measured by median age.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(median_age, estimate) <span class="co">#youngest counties by median age, ascending order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,221 × 5
   GEOID NAME                          variable   estimate   moe
   &lt;chr&gt; &lt;chr&gt;                         &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
 1 35011 De Baca County, New Mexico    B01002_001     22.2   6.9
 2 51678 Lexington city, Virginia      B01002_001     22.2   0.8
 3 16065 Madison County, Idaho         B01002_001     23.5   0.2
 4 46121 Todd County, South Dakota     B01002_001     23.6   0.6
 5 51750 Radford city, Virginia        B01002_001     23.7   0.6
 6 13053 Chattahoochee County, Georgia B01002_001     24     0.7
 7 02158 Kusilvak Census Area, Alaska  B01002_001     24.1   0.2
 8 49049 Utah County, Utah             B01002_001     25     0.1
 9 46027 Clay County, South Dakota     B01002_001     25.2   0.5
10 53075 Whitman County, Washington    B01002_001     25.2   0.2
# ℹ 3,211 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(median_age, <span class="fu">desc</span>(estimate)) <span class="co">#oldest counties by median age, descending order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,221 × 5
   GEOID NAME                            variable   estimate   moe
   &lt;chr&gt; &lt;chr&gt;                           &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
 1 12119 Sumter County, Florida          B01002_001     68     0.3
 2 48301 Loving County, Texas            B01002_001     62.2  37.8
 3 48243 Jeff Davis County, Texas        B01002_001     61.3  36.8
 4 08027 Custer County, Colorado         B01002_001     60.1   3.4
 5 12015 Charlotte County, Florida       B01002_001     59.5   0.2
 6 51091 Highland County, Virginia       B01002_001     59.5   4.8
 7 35003 Catron County, New Mexico       B01002_001     59.4   2.6
 8 51133 Northumberland County, Virginia B01002_001     59.3   0.7
 9 26131 Ontonagon County, Michigan      B01002_001     59.1   0.5
10 48443 Terrell County, Texas           B01002_001     59.1   9.4
# ℹ 3,211 more rows</code></pre>
</div>
</div>
<p>Another useful function is the <code>filter()</code> function, which queries a dataset for rows <em>where</em> a given condition evaluates to TRUE, and retains those rows only. When analysts need to narrow down data by their characteristics, this function can answer questions like the one below: “how many counties in the US have a median age of 50 or older?”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(median_age, estimate <span class="sc">&gt;=</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 218 × 5
   GEOID NAME                              variable   estimate   moe
   &lt;chr&gt; &lt;chr&gt;                             &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
 1 02105 Hoonah-Angoon Census Area, Alaska B01002_001     52.1   2.9
 2 04007 Gila County, Arizona              B01002_001     50.4   0.2
 3 04012 La Paz County, Arizona            B01002_001     57.4   0.6
 4 04015 Mohave County, Arizona            B01002_001     52.3   0.2
 5 04025 Yavapai County, Arizona           B01002_001     54.1   0.2
 6 05005 Baxter County, Arkansas           B01002_001     52.3   0.5
 7 05089 Marion County, Arkansas           B01002_001     52.1   0.8
 8 05097 Montgomery County, Arkansas       B01002_001     50.6   0.8
 9 05137 Stone County, Arkansas            B01002_001     50     0.5
10 06009 Calaveras County, California      B01002_001     52.8   0.6
# ℹ 208 more rows</code></pre>
</div>
</div>
<p>While many of the functions above focus on rows, <code>separate()</code> focuses on columns. Similar to the “text to columns” function on Excel, below the <code>NAME</code> column is split into two columns where one retains the county name and the other retains the state. The default <strong>tidycensus</strong> treats the <code>NAME</code> more as a descriptor–in this case formatted as “X County, Y State”. This is more intuitive than the <code>GEOID</code>, but separating the geographic scales into respective categories increases comparability across different datasets for analysts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  median_age,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  NAME,</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"county"</span>, <span class="st">"state"</span>),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">", "</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,221 × 6
   GEOID county          state   variable   estimate   moe
   &lt;chr&gt; &lt;chr&gt;           &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
 1 01001 Autauga County  Alabama B01002_001     38.6   0.6
 2 01003 Baldwin County  Alabama B01002_001     43.2   0.4
 3 01005 Barbour County  Alabama B01002_001     40.1   0.6
 4 01007 Bibb County     Alabama B01002_001     39.9   1.2
 5 01009 Blount County   Alabama B01002_001     41     0.5
 6 01011 Bullock County  Alabama B01002_001     39.7   1.9
 7 01013 Butler County   Alabama B01002_001     41.2   0.6
 8 01015 Calhoun County  Alabama B01002_001     39.5   0.4
 9 01017 Chambers County Alabama B01002_001     41.9   0.7
10 01019 Cherokee County Alabama B01002_001     46.8   0.5
# ℹ 3,211 more rows</code></pre>
</div>
</div>
<p>Another common statistical issue is the normalization/standardization of count data for analysis. For the ACS, taking the estimated count data and dividing it by the overall population from which the sub-group is derived is possible because such denominators are frequently found in the tables as variables. In ACS table B19001, which covers the number of households by income bands, the variable B19001_001 represents the total number of households in a given iteration, which was removed from our analysis earlier. This variable would serve as the total (denominator) for the other variables in the table, so in this case that would need its own column to facilitate the calculation of proportions or percentages.</p>
<p>By supplying a variable ID to the <code>summary_var</code> parameter in both the <code>get_acs()</code> and <code>get_decennial()</code> functions, <code>get_decennial()</code> warrants the creation of two new columns for the decennial Census datasets, summary_var (summary variable ID) and summary_value (summary variable’s value). The <code>get_acs()</code> function warrants the creation of three new columns for the ACS datasets, summary_var, summary_est, and summary_moe, which include the ACS estimate and margin of error for the summary variable. The example below utilizes this in the context of population of counties in Arizona by race &amp; Hispanic origin with their baseline populations, using data from the 2016-2020 ACS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>race_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">White =</span> <span class="st">"B03002_003"</span>,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Black =</span> <span class="st">"B03002_004"</span>,</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Native =</span> <span class="st">"B03002_005"</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Asian =</span> <span class="st">"B03002_006"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">HIPI =</span> <span class="st">"B03002_007"</span>,</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Hispanic =</span> <span class="st">"B03002_012"</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>az_race <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"AZ"</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> race_vars,</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">summary_var =</span> <span class="st">"B03002_001"</span>,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>The <code>mutate()</code> function calculates a new column/percent, representing the percentage of each Census tract’s population that corresponds to each racial/ethnic group from 2016-2020. The select() function retains only those columns that we need to view.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>az_race_percent <span class="ot">&lt;-</span> az_race <span class="sc">%&gt;%</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> (estimate <span class="sc">/</span> summary_est)) <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(NAME, variable, percent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>%\&gt;%</code> operator (magrittr R package) is a pipe operator that allows for analysts to develop an analytic workflow, passing the result of a given line of code from the first argument of the code on the next line.</p>
<p>The operator can also be read as a “then” statement–in this context asking character-wise to “create a new data object az_race_percent from the existing data object az_race THEN create a new percent column for that new data object THEN select the <code>NAME</code>, <code>variable</code>, and <code>percent</code> columns”.</p>
</section>
</section>
<section id="group-wise-analysis" class="level1">
<h1>Group-wise Analysis</h1>
<p>The split-apply-combine is a common workflow by analysts implemented with the <code>group_by()</code> function, splitting a dataset into groups (split) to allow subsequent functions to be used in an analytic pipeline (apply) to be applied to each group then combined back into a single dataset (combine).</p>
<p>Below, we utilize this function to identify the largest racial or ethnic group in each county in Arizona. First, we split the dataset by calculating a <code>filter()</code> operation that will be applied specific to each group. The condition is specified as <code>percent == max(percent)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>largest_group <span class="ot">&lt;-</span> az_race_percent <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(percent <span class="sc">==</span> <span class="fu">max</span>(percent))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As a “then” statement, we ask to “create a new dataset called largest_group in context of the az_race_dataset THEN grouping the dataset by the NAME column THEN filtering for rows that are equal to the maximum value of percent for each group.”</p>
<p>The <code>group_by()</code> function is commonly paired with the <code>summarize()</code> function in data analysis pipelines. The <code>summarize()</code> creates a new, condensed dataset that by default returns a column for the grouping variable(s) and columns representing the results of one or more functions applied to those groups. Below, the <code>median()</code> function is used to take the grouped race and ethnicity variables (categories) and calculates their median percentage for each of the in the dataset across counties in Arizona.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>az_race_percent <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">median_pct =</span> <span class="fu">median</span>(percent))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  variable median_pct
  &lt;chr&gt;         &lt;dbl&gt;
1 Asian         0.992
2 Black         1.29 
3 HIPI          0.107
4 Hispanic     30.5  
5 Native        3.63 
6 White        53.8  </code></pre>
</div>
</div>
</section>
<section id="new-groups" class="level1">
<h1>New Groups</h1>
<p>In addition to splitting, splicing, and combining groups, analysts will also create new, custom groups that may widen or narrow existing variables, or calculate sums.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>mn_hh_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> <span class="st">"B19001"</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"MN"</span>,</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2016</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2012-2016 5-year ACS</code></pre>
</div>
</div>
<p>Our data has each variable as a different household income category for each county. These cateogries may be a little too specific for the analysis or visualization of the data, so below we will broaden the groups to sort households into only three categories of income: below $35,000/year, between $35,000/year and $75,000/year, and $75,000/year and up.</p>
<p>First, we will comb out unecessary variables using <code>filter()</code>, such as the variable B19001_001, which represents the total number of households for each county in order to lessen the risk of double counting. Second, we use the <code>case_when()</code> function to identify then place groups of variables that correspond to our desired groupings–the three categories of income. Due to the ACS order of variables, the less than operator can be used to identify groups.</p>
<p>Within the <code>mutate()</code> function, it creates a new variable named incgroup. The <code>case_when()</code> function evaluates a series of logical conditions, similar to if/else statements. Each condition is evaluated in sucession, first assigning the value of below35k to all rows with a variable value that comes before “B19001_008” - which in this case will be B19001_002 (income less than $10,000) through B19001_007 (income between $30,000 and $34,999). It them moves onto the second condition, evaluating the rows not accounted for by the first condition, as ‘case_when()’ knows not to assign “bw35kand75k” to the income group of $10,000 and below even though its variable comes before B19001_013. The final condition can be set to TRUE, signifying the grouping to “all other values”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>mn_hh_income_recode <span class="ot">&lt;-</span> mn_hh_income <span class="sc">%&gt;%</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">!=</span> <span class="st">"B19001_001"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">incgroup =</span> <span class="fu">case_when</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">&lt;</span> <span class="st">"B19001_008"</span> <span class="sc">~</span> <span class="st">"below35k"</span>, </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    variable <span class="sc">&lt;</span> <span class="st">"B19001_013"</span> <span class="sc">~</span> <span class="st">"bw35kand75k"</span>, </span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"above75k"</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Our result shows the three new recoded categories specified in case_when() when you open the table.</p>
<p>The <code>group_by()</code> <code>%\&gt;%</code> <code>summarize()</code> workflow is applied to the recoded categories to organize the data into a smaller number of groups–creating only three estimates per county.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>mn_group_sums <span class="ot">&lt;-</span> mn_hh_income_recode <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID, incgroup) <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">estimate =</span> <span class="fu">sum</span>(estimate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'GEOID'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="time-series" class="level1">
<h1>Time Series</h1>
<p>Time has always been a well-sought analytic component of data. Many analysts examine demographic change over time with Census Data. Note that the census API and <strong>tidycensus</strong> only go back to the 2000s and that geography changes over time. Below we want to retrieve demographic data from 2020 and 2010 for a county in South Dakota.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>oglala_lakota_age <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"SD"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Oglala Lakota"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> <span class="st">"B01001"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>) <span class="co">#recent from 2020</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading ACS5 variables for 2020 from table B01001. To cache this dataset for faster access to ACS tables in the future, run this function with `cache_table = TRUE`. You only need to do this once per ACS dataset.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#oglala_lakota_age_10 &lt;- get_acs(</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  geography = "county",</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  state = "SD",</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  county = "Oglala Lakota",</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  table = "B01001",</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  year = 2010</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co">#) #from the past 2010</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A request error will result because Oglala Lakota County was formally referred to as Shannon County in 2010, so looking up Oglala Lakota will not return data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>oglala_lakota_age_10 <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"SD"</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Shannon"</span>, <span class="co">#changed it</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">table =</span> <span class="st">"B01001"</span>,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2010</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2006-2010 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading ACS5 variables for 2010 from table B01001. To cache this dataset for faster access to ACS tables in the future, run this function with `cache_table = TRUE`. You only need to do this once per ACS dataset.</code></pre>
</div>
</div>
<p>Note the differences in the GEOID between the two tables of data. When a county or geographic area changes its name, the Census Bureau assigns it a new GEOID, which they tend to note on their website when it occurs.</p>
<p>variable IDs can change over time as well. If we were interested in analyzing the percentage of residents age 25 and up with a 4-year college degree for counties in Colorado from the 2019 1-year ACS. We’d first look up the appropriate variable ID with <code>load_variables(2019, "acs1/profile")</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>co_college19 <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"DP02_0068P"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"CO"</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2019 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Data Profile</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>co_college18 <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"DP02_0068P"</span>,</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"CO"</span>,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span>,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2018</span> <span class="co">#same code, different year</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2018 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Data Profile</code></pre>
</div>
</div>
<p>The values are not percentages because variable IDs for the Data Profile are unique to each year, thus should not be used for time-series analysis. The Comparison Profile Tables can be used instead, with both the 1-year and 5-year ACS and mode of comparison of demographic indicators over the past 5 years for a given year.</p>
<p>Below we show how to get the ACS Comparison Profile on inflation-adjusted median household income for counties and county-equivalents in Alaska. Note that for the 2016-2020 ACS the “comparison year” is 2015, the closest non-overlapping 5-year dataset (2011-2015).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>ak_income_compare <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">income15 =</span> <span class="st">"CP03_2015_062"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">income20 =</span> <span class="st">"CP03_2020_062"</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"AK"</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Comparison Profile</code></pre>
</div>
</div>
<p>Detailed tables have variable IDs that remain consistent yearly, however the census will add and remove variables from surveys based data needs/availability. Be sure to check on data availability using <code>load_variables()</code> for the years you plan on looking at.</p>
<p>Below we re-compute for a time series from 2010 to 2019. The census splits information on “bachelor’s degree or higher” by sex and across different tiers of education in ACS table 15002. We use the <code>c()</code> to narrow it to the variables age 25+ and 4 year+ degree by requesting the specific variables in that table.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>college_vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"B15002_015"</span>,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"B15002_016"</span>,</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"B15002_017"</span>,</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"B15002_018"</span>,</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"B15002_032"</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"B15002_033"</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"B15002_034"</span>,</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"B15002_035"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>While the calls from ACS will retrieve, it can be tedious to write out each variable especially for large datasets. We will use iteration to efficently carry out the same process over a sequence of values (“loop” operators). Below, we utilize the function <code>map_dfr()</code> from <strong>tidycensus</strong> that iterates over an input (for the years 2010 through 2019) and applies it to a function or process defined by the user, then row-binds the result into a single data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2010</span><span class="sc">:</span><span class="dv">2019</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(years) <span class="ot">&lt;-</span> years</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>college_by_year <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> college_vars,</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"CO"</span>,</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">summary_var =</span> <span class="st">"B15002_001"</span>,</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs1"</span>,</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2010 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2011 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2012 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2013 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2014 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2015 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2017 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2018 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2019 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
</div>
<p><code>map_dfr()</code> then takes three arguments above–first is that <code>map_dfr()</code> will iterate over the years vector. Second is a formula specified with the tilde (~) operator and curly braces ({…}), as the code inside the curly braces is run once for each element of years, where local variable .x inside the formula takes on each value of years sequentially. We are running the equivalent of get_acs() for each year and the result is combined into a single output data frame. The .id argument creates a new column in the data frame for the new values, naming that column year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>college_by_year <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(NAME, variable, year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 920 × 8
   year  GEOID NAME              variable estimate   moe summary_est summary_moe
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;
 1 2010  08001 Adams County, Co… B15002_…    20501  1983      275849         790
 2 2011  08001 Adams County, Co… B15002_…    21233  2124      281231         865
 3 2012  08001 Adams County, Co… B15002_…    19238  2020      287924         693
 4 2013  08001 Adams County, Co… B15002_…    23818  2445      295122         673
 5 2014  08001 Adams County, Co… B15002_…    20255  1928      304394         541
 6 2015  08001 Adams County, Co… B15002_…    22962  2018      312281         705
 7 2016  08001 Adams County, Co… B15002_…    25744  2149      318077         525
 8 2017  08001 Adams County, Co… B15002_…    26159  2320      324185         562
 9 2018  08001 Adams County, Co… B15002_…    28113  2078      331247         955
10 2019  08001 Adams County, Co… B15002_…    27552  2070      336931         705
# ℹ 910 more rows</code></pre>
</div>
</div>
<p>The resulting dataset contains a time series of each variable for each county in Colorado available in the 1-year ACS.</p>
<p>Below, a <code>group_by()</code> <code>%\&gt;%</code> <code>summarize()</code> workflow is calculating the percentage of the population age 25 and up with a 4-year college degree. The <code>pivot_wider()</code> function spreads the years across the columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>percent_college_by_year <span class="ot">&lt;-</span> college_by_year <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME, year) <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">numerator =</span> <span class="fu">sum</span>(estimate),</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">denominator =</span> <span class="fu">first</span>(summary_est)) <span class="sc">%&gt;%</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pct_college =</span> <span class="dv">100</span> <span class="sc">*</span> (numerator <span class="sc">/</span> denominator)) <span class="sc">%&gt;%</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> NAME,</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> year,</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> pct_college)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'NAME'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<section id="acs-margins-of-error" class="level2">
<h2 class="anchored" data-anchor-id="acs-margins-of-error">ACS Margins of Error</h2>
<p>American Community SUrvey MOEs are returned at a 90 percent confidence level, but <strong>tidycensus</strong> can also return MOEs at a confidence level of 95 or 99 using Census-recommended formulas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_acs</span>(</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Rhode Island"</span>,</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B19013_001"</span>,</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>) <span class="co">#default to 90 moe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  GEOID NAME                            variable   estimate   moe
  &lt;chr&gt; &lt;chr&gt;                           &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
1 44001 Bristol County, Rhode Island    B19013_001    85413  6122
2 44003 Kent County, Rhode Island       B19013_001    75857  2022
3 44005 Newport County, Rhode Island    B19013_001    84282  2629
4 44007 Providence County, Rhode Island B19013_001    62323  1270
5 44009 Washington County, Rhode Island B19013_001    86970  3651</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_acs</span>(</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Rhode Island"</span>,</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B19013_001"</span>,</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span>,</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">moe_level =</span> <span class="dv">99</span> <span class="co">#changed to 99 moe</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  GEOID NAME                            variable   estimate   moe
  &lt;chr&gt; &lt;chr&gt;                           &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
1 44001 Bristol County, Rhode Island    B19013_001    85413 9587.
2 44003 Kent County, Rhode Island       B19013_001    75857 3166.
3 44005 Newport County, Rhode Island    B19013_001    84282 4117.
4 44007 Providence County, Rhode Island B19013_001    62323 1989.
5 44009 Washington County, Rhode Island B19013_001    86970 5717.</code></pre>
</div>
</div>
<p>As you may have noticed, the small geographies or small populations, margins of error are large, sometimes exceeding their corresponding estimates.</p>
<p>Below, we will first generate a vector of variable IDs, using <code>load_variables()</code> to look up estimates for populations age 65 and up (B01001_020-B01001_025 for males, B01001_044-B01001_049 for females). Instead of typing out each variable, we use string concatenation through <code>c()</code> and <code>:</code> to generate the vector of variable IDs.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"B01001_0"</span>, <span class="fu">c</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">44</span><span class="sc">:</span><span class="dv">49</span>))</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "B01001_020" "B01001_021" "B01001_022" "B01001_023" "B01001_024"
 [6] "B01001_025" "B01001_044" "B01001_045" "B01001_046" "B01001_047"
[11] "B01001_048" "B01001_049"</code></pre>
</div>
</div>
<p>The resulting variables object is named <code>vars</code>, which can be used to request variables in a <code>get_acs()</code> call.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>salt_lake <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"tract"</span>,</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> vars,</span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Utah"</span>,</span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="st">"Salt Lake"</span>,</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>To examine the returned data’s margins of error, below we focus on a specific Census tract in Salt Lake County using <code>filter()</code> and inputting the <code>GEOID</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>example_tract <span class="ot">&lt;-</span> salt_lake <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(GEOID <span class="sc">==</span> <span class="st">"49035100100"</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>example_tract <span class="sc">%&gt;%</span> </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>NAME)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   GEOID       variable   estimate   moe
   &lt;chr&gt;       &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;
 1 49035100100 B01001_020       11    13
 2 49035100100 B01001_021       25    18
 3 49035100100 B01001_022        7    10
 4 49035100100 B01001_023        4     7
 5 49035100100 B01001_024        0    12
 6 49035100100 B01001_025       17    20
 7 49035100100 B01001_044        0    12
 8 49035100100 B01001_045        4     7
 9 49035100100 B01001_046       21    17
10 49035100100 B01001_047      123   168
11 49035100100 B01001_048       17    21
12 49035100100 B01001_049        0    12</code></pre>
</div>
</div>
<p>One solutions to large margins of error for small estimates is to find aggregate data upwards until a satisfactory margin of error to estimate ratio is reached, similar to how I scaled up Maryland counties to Maryland as a whole for data retrieval prior in part 2 when I was getting a lot of NAs.</p>
<p>One of several formulas for appropriately calculating margins of error is the <code>moe_prop()</code> function, which calculates a margin of error for a derived proportion.</p>
<p>Below we have an ACS estimate of 25 with a margin of error of 5. The appropriate denominator for this estimate is 100 with a margin of error of 3. To determine the margin of error around the derived proportion of 0.25, we use the function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moe_prop</span>(<span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">5</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0494343</code></pre>
</div>
</div>
<p>With group-wise margins of error, below we use the <code>case_when()</code> function to create a new column, <code>sex</code>, attributing the variables to their sex categories. Then a <code>group_by()</code> <code>%\&gt;%</code> <code>summarize()</code> workflow aggregates our data by Census tract and sex. Then, the <code>summarize()</code> calls to the <code>moe_sum()</code> function, which calculates then generates a new column with the margin of error around the derived sum.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>salt_lake_grouped <span class="ot">&lt;-</span> salt_lake <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">case_when</span>(</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_sub</span>(variable, <span class="at">start =</span> <span class="sc">-</span><span class="dv">2</span>) <span class="sc">&lt;</span> <span class="st">"26"</span> <span class="sc">~</span> <span class="st">"Male"</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Female"</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID, sex) <span class="sc">%&gt;%</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">sum_est =</span> <span class="fu">sum</span>(estimate), </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum_moe =</span> <span class="fu">moe_sum</span>(moe, estimate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'GEOID'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>The new margins of error (relative to the estimates) are now much more reasonable and useful when aggregated!</p>
<p>A quick note to check first if your desired data is already in aggregated form elsewhere before doing the MOE estimation yourself. The ACS combined tables, Data Profile, or Subject Tables often include pre-computed margins of error.</p>
</section>
<section id="visualization-chapter-4" class="level2">
<h2 class="anchored" data-anchor-id="visualization-chapter-4">Visualization (Chapter 4)</h2>
<p>The final foundational component is utilizing these retrieved datsets for visualization in a variety of forms. The ideal package for this task would be <strong>ggplot2</strong>, which produces statistical or data graphics, however has an underlying grammar that allows you to compose graphs by combining independent components (Grammar of Graphics).</p>
<p>Below is the same command from the <strong>Data Strcuture</strong> section, fetching data on median household income and median age by county in Maryland from the 2016-2020 ACS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>mdmed_wide <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Maryland"</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="at">medinc =</span> <span class="st">"B19013_001"</span>,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">medage =</span> <span class="st">"B01002_001"</span>),</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">"wide"</span>,</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>The <code>ggplot()</code> function initiates the visualizations, where we supply the referenced dataset as well as the aesthetic with the <code>aes()</code> function to specify series on axes and element fill/color. Then, the <code>geom</code> that is linked as a layer of this plot with the <code>+</code> specifies which chart type would be outputted (bar, line, etc.). Below we output the chart as a histogram (<code>geom_histogram</code>). Note the optional call to <code>options(scipen = 999)</code> that instructs R to avoid using scientific notation in its output, including on the <strong>ggplot2</strong> tick labels.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mdmed_wide, <span class="fu">aes</span>(<span class="at">x =</span> medincE)) <span class="sc">+</span> </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/visual2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The results should produce a histogram visual of median household income in Maryland counties. They are categorized into bins along the x-axis, which can be modified using the <code>bins =</code> argument in the <code>geom_histogram</code> function (<strong>ggplot2</strong> defaults to 30 bins).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mdmed_wide, <span class="fu">aes</span>(<span class="at">x =</span> medincE)) <span class="sc">+</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/visual3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Below is another visualization, the box-and-whisker plot that can be utilized with the <code>geom_boxplot()</code>, where the <code>medincE</code> variable is moved from <code>x</code> to <code>y</code> (axis).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mdmed_wide, <span class="fu">aes</span>(<span class="at">y =</span> medincE)) <span class="sc">+</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/visual4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The past couple visuals have been for one variable visualizations, but below is a visual for two variables, the scatterplot, which is implemented with the <code>geom_point()</code> function. Within the <code>aes()</code>function specify the arguments for <code>x</code> = and <code>y</code> = with the variables/columns from the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mdmed_wide, <span class="fu">aes</span>(<span class="at">x =</span> medageE, <span class="at">y =</span> medincE)) <span class="sc">+</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/visual5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To discern clearer correlations, you may want to layer on a line of best fit. <strong>ggplot2</strong> has the <code>geom_smooth()</code> function to add (<code>+</code>) on the scatterplot, drawing a straight line with the argument <code>method = 1m</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mdmed_wide, <span class="fu">aes</span>(<span class="at">x =</span> medageE, <span class="at">y =</span> medincE)) <span class="sc">+</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/visual6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="customization" class="level2">
<h2 class="anchored" data-anchor-id="customization">Customization</h2>
<p>While the default visuals are great for exploration, you can also customize your visuals for more formal modes of presentation. Below is the contextual data to be visualized, to find the percent of commuters that take public transportation to work for the largest metropolitan areas in the United States.</p>
<p>While we are taking from variable <code>DP03_0021P</code>, we will need to comb through the data in descending order of the summary variable of total population and retain the 20 largest metropolitan using the <code>slice_max()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>metros <span class="ot">&lt;-</span>  <span class="fu">get_acs</span>(</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"cbsa"</span>,</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"DP03_0021P"</span>,</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">summary_var =</span> <span class="st">"B01003_001"</span>,</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">survey =</span> <span class="st">"acs1"</span>,</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(summary_est, <span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2019 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the ACS Data Profile</code></pre>
</div>
</div>
<p>The results will have 20 rows and 7 columns into a new dataset called metros. This will be utilized below to create a bar chart using the <code>geom_col()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(metros, <span class="fu">aes</span>(<span class="at">x =</span> NAME, <span class="at">y =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/custom2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that the resulting bar chart properly visualizes the data, but the axis and variables provide little aid, as the acis names are vague and the x-axis in particular has lengthy, overlapping labels of the metro areas.</p>
<p>To remedy this, we will first rename the <code>NAME</code> column to the first principal city of the metro area using the <code>str_remove()</code>function within the <code>mutate()</code> function (which accounts for the various metropolitan area names). Below uses regular expressions to first remove all the text after the first dash, then remove the text after the first comma if no dash was originally present.</p>
<p>Next, we will flip the <code>x</code> and <code>y</code> variables to accommodate the metro name length, using the <code>reorder()</code> function to switch the original <code>aes()</code> formatting and putting the bar chart on its side, then reordering the data in descending order with the context provided by the <code>mutate()</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>metros <span class="sc">%&gt;%</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">"-.*$"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">",.*$"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(NAME, estimate), <span class="at">x =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/custom3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot looks much cleaner after the modifications, showcasing clearer patterns. However the readability is still not sufficient with the current x and y-axis label names and no titles. Using the <code>labs()</code> function, we can add a title, subtitle, and even source with the <code>title =</code>, <code>subititle =</code>, and <code>caption =</code> arguments, and specify labels with the <code>y =</code> and <code>x =</code> arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>metros <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">"-.*$"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">",.*$"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(NAME, estimate), <span class="at">x =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span>  </span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Public transit commute share"</span>, </span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2019 1-year ACS estimates"</span>, </span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>, </span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ACS estimate"</span>, </span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: ACS Data Profile variable DP03_0021P via the tidycensus R package"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/custom4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that the y axis we changed to a blank name to remove it considering that the y variables speak for themselves as cities. The result is now a polished plot ready for more formal analysis.</p>
<p>However, if you want to take it a step further, customizing the style, color scheme, and more for your visuals can be done with <code>ggplot2</code>. Below are a few modifications done, with the <code>geom_col()</code> specifying the bar coloration, <code>theme_minimal()</code> changing the font, and <code>scale_x_continuous</code> modifying the display of the x-axis values to percents.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>metros <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">"-.*$"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">",.*$"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">reorder</span>(NAME, estimate), <span class="at">x =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"navy"</span>, <span class="at">fill =</span> <span class="st">"navy"</span>, </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.85</span>) <span class="sc">+</span>  </span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>, <span class="at">base_family =</span> <span class="st">"Verdana"</span>) <span class="sc">+</span> </span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>(<span class="at">scale =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Public transit commute share"</span>, </span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2019 1-year ACS estimates"</span>, </span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>, </span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"ACS estimate"</span>, </span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: ACS Data Profile variable DP03_0021P via the tidycensus R package"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database

Warning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family
not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/custom5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The resulting graph is even better than the default!</p>
</section>
<section id="exportation" class="level2">
<h2 class="anchored" data-anchor-id="exportation">Exportation</h2>
<p>With all of your visuals up to par, you will likely want to export them out of R for display elsewhere. While RStudio has a simple command for exportation, <strong>ggplot2</strong> can give more programmatic control.</p>
<p>Below, the <code>ggsave()</code> function will save the last plot generated to an image file in the user’s current working directory by default. The specified file extension will control the output image format, e.g.&nbsp;<code>.png</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"metro_transit.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
</div>
<p>For that programmatic edge, you can include arguments as shown below to adjust size (<code>width</code>, <code>height</code>) and resolution (<code>dpi</code>), then you can ensure the <code>path</code> where it will be saved.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"metro_transit.png"</span>,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"~/images"</span>,</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">8</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">5</span>,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"in"</span>,</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="margin-of-error-visuals" class="level2">
<h2 class="anchored" data-anchor-id="margin-of-error-visuals">Margin of Error Visuals</h2>
<p>Much of the visualizing thus far has been with the ACS estimations, but the margins of error can prove just as useful when visualized in accordance with the estimations.</p>
<p>Below we are pulling the number of counties and their total population in Maine from the 2016-2020 ACS to examine the ranges in which margins of error could be greater or smaller, as estimates for the counties with smaller population sizes are likely to have a larger margin of error than those with larger baseline populations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>maine <span class="ot">&lt;-</span> <span class="fu">get_decennial</span>(</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Maine"</span>,</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="at">totalpop =</span> <span class="st">"P1_001N"</span>),</span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2020 decennial Census</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Using the PL 94-171 Redistricting Data Summary File</code></pre>
</div>
</div>
<p>Now, we’ll examine median household incomes of the counties in Maine from the 2016-2020 ACS. After calling the dataset from the ACS, we will alse use the <code>str_remove()</code> function to remove redundancies and clean up the <code>NAME</code> column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>maine_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"Maine"</span>,</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="at">hhincome =</span> <span class="st">"B19013_001"</span>),</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME =</span> <span class="fu">str_remove</span>(NAME, <span class="st">" County, Maine"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>As covered in the **Visualization* section, we call to produce a scatterplot, display the rankings in descending order, and customize the style.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(maine_income, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(NAME, estimate))) <span class="sc">+</span> </span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span> </span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median household income"</span>, </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Counties in Maine"</span>, </span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ACS estimate"</span>) <span class="sc">+</span> </span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="fl">12.5</span>) <span class="sc">+</span> </span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/moev3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The decision for a scatterplot in this visual can help pave proper usage of the margins of error as error bars. Below, we are simply examining the descending order of the data to view the margins of error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>maine_income <span class="sc">%&gt;%</span> </span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(moe))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 5
   GEOID NAME         variable estimate   moe
   &lt;chr&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;
 1 23023 Sagadahoc    hhincome    68039  4616
 2 23015 Lincoln      hhincome    58125  3974
 3 23027 Waldo        hhincome    58034  3482
 4 23007 Franklin     hhincome    51630  2948
 5 23021 Piscataquis  hhincome    42083  2883
 6 23025 Somerset     hhincome    45382  2694
 7 23009 Hancock      hhincome    58345  2593
 8 23013 Knox         hhincome    57794  2528
 9 23017 Oxford       hhincome    49761  2380
10 23003 Aroostook    hhincome    43791  2306
11 23029 Washington   hhincome    44847  2292
12 23031 York         hhincome    68932  2239
13 23011 Kennebec     hhincome    55368  2112
14 23001 Androscoggin hhincome    55002  2003
15 23019 Penobscot    hhincome    52128  1836
16 23005 Cumberland   hhincome    76014  1563</code></pre>
</div>
</div>
<p>While the rankings along each county appear vast, the error bars create uncertainty that proves crucial when it comes to conclusions.</p>
<p>Below, we utilize the <code>geom_errorbar()</code> function to create horizontal (<code>h</code>) error bars, utilizing the <code>moe</code> column subtracted or added off of the <code>estimate</code> values for the length of the bars. The <code>xmin</code> and <code>xmax</code> signify the minimum and maximum lengths along the x-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(maine_income, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(NAME, estimate))) <span class="sc">+</span> </span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> estimate <span class="sc">-</span> moe, <span class="at">xmax =</span> estimate <span class="sc">+</span> moe)) <span class="sc">+</span> </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span> </span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="fl">12.5</span>) <span class="sc">+</span> </span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median household income"</span>, </span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Counties in Maine"</span>, </span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"2016-2020 ACS estimate"</span>, </span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/moev5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The inclusion of the error bars provides better understanding of actual income activity in the respective counties. For example, while the ACS estimate suggests that Piscataquis County has the lowest median household income, the large margin of error suggests that either Aroostook or Washington Counties above in ranking could have lower median household incomes.</p>
</section>
<section id="estimation-visuals" class="level2">
<h2 class="anchored" data-anchor-id="estimation-visuals">Estimation Visuals</h2>
<p>While we examined shifts in data over time, we can also look at ways to visualize them using <strong>ggplot2</strong>.</p>
<p>Below, we will retrieve 1-year ACS data from 2005 through 2019 on median home value for Deschutes County, Oregon. We will use the <code>map_dfr()</code>function to iterate over a named vector of years and creating a time-series dataset called <code>deschutes_value</code>. We will also use the formula specification for anonymous functions so that <code>~ .x</code> translates to <code>function(x) x</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="dv">2005</span><span class="sc">:</span><span class="dv">2019</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(years) <span class="ot">&lt;-</span> years</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>deschutes_value <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(years, <span class="sc">~</span>{</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_acs</span>(</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">geography =</span> <span class="st">"county"</span>,</span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">variables =</span> <span class="st">"B25077_001"</span>,</span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">state =</span> <span class="st">"OR"</span>,</span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">county =</span> <span class="st">"Deschutes"</span>,</span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> .x,</span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">survey =</span> <span class="st">"acs1"</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>}, <span class="at">.id =</span> <span class="st">"year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2005 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2006 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2007 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2008 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2009 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2010 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2011 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2012 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2013 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2014 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2015 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2017 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2018 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2019 1-year ACS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The 1-year ACS provides data for geographies with populations of 65,000 and greater.</code></pre>
</div>
</div>
<p>We use the <code>deschutes_value</code> dataset to make a plot (<code>year</code> on x-axis, <code>estimate</code> on y-axis) using the <code>geom_line</code> function for the line graph and <code>geom_point</code> function to layer the points on top if it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(deschutes_value, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> estimate, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/estv2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we examine the trends of the line chart over time, we may want to include the margins of error. Since we cannot so readily make horizontal error bars without confusing the audience, we will use the <code>geom_ribbon</code> function to create a transparent <code>navy</code> ribbon surrounding the line, modifying the <code>caption =</code> as well to indicate what the ribbon represents. We also modified the y-axis value labels with the <code>scale_y_continuous</code> function to a more monetary format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(deschutes_value, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> estimate, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymax =</span> estimate <span class="sc">+</span> moe, <span class="at">ymin =</span> estimate <span class="sc">-</span> moe), </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">"navy"</span>,</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"navy"</span>) <span class="sc">+</span> </span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"navy"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)) <span class="sc">+</span> </span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median home value in Deschutes County, OR"</span>,</span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"ACS estimate"</span>,</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Shaded area represents margin of error around the ACS estimate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/estv3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now you have a cohesive time series chart!</p>
</section>
<section id="population-pyramids" class="level2">
<h2 class="anchored" data-anchor-id="population-pyramids">Population Pyramids</h2>
<p>Another mode of visualization in line with the Census Bureau is population pyramids, as they can visualize population size/proportion, age, and sex.</p>
<p>Below we are retrieving the Population Estimates API for the state of Utah with the <code>get_estimates()</code> function to a new dataset, <code>utah</code>, broken down (<code>breakdown =</code>) into sex and age group columns that each population group is assigned to.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>utah <span class="ot">&lt;-</span> <span class="fu">get_estimates</span>(</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"UT"</span>,</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">product =</span> <span class="st">"characteristics"</span>,</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breakdown =</span> <span class="fu">c</span>(<span class="st">"SEX"</span>, <span class="st">"AGEGROUP"</span>),</span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">breakdown_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will need to isolate those rows that represent five-year age bands by sex, and remove the rows that do not, as the first few rows represent population values for “Both sexes” or for “All ages”.</p>
<p>The five-year age bands are identified in the <code>AGEGROUP</code> column beginning with the word “Age”, so we can filter out the rows that match that pattern using the <code>filter()</code> function.</p>
<p>Since this x-axis of this population pyramid will also need to be visually split down the middle between sexes, we will also <code>mutate()</code> the data to set all <code>MALE</code> values to negative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>utah_filtered <span class="ot">&lt;-</span> <span class="fu">filter</span>(utah, <span class="fu">str_detect</span>(AGEGROUP, <span class="st">"^Age"</span>), </span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>                  SEX <span class="sc">!=</span> <span class="st">"Both sexes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="st">"Male"</span>, <span class="sc">-</span>value, value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that the data is prepared, we can visualize it as a bar graph using the <code>geom_col()</code> function, where we specify the x-axis as the population estimates and the the y-axis to the agegroup, and how <code>SEX</code> can be mapped to the fill aesthetic (<code>fill =</code>) in order to plotting these categories by color.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(utah_filtered, <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> AGEGROUP, <span class="at">fill =</span> SEX)) <span class="sc">+</span> </span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/pyramid3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now for the customization part, where we change the <code>y</code> labels to remove the redundant “age” and “years”, as well as the axis names. We also format the axis tick labels by using appropriate <code>scale_*</code> functions, setting the X-axis limits to show both sides of 0 equally. Lastly, we changed the theme to <code>theme_minimal</code> to fade the gridlines into a white background and let the bars stand out.</p>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>utah_pyramid <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(utah_filtered, </span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> value, </span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y =</span> AGEGROUP, </span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">fill =</span> SEX)) <span class="sc">+</span> </span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.95</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span> </span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Verdana"</span>, </span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span> </span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="sc">~</span> <span class="fu">number_format</span>(<span class="at">scale =</span> .<span class="dv">001</span>, <span class="at">suffix =</span> <span class="st">"k"</span>)(<span class="fu">abs</span>(.x)),</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="dv">140000</span> <span class="sc">*</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="sc">~</span> <span class="fu">str_remove_all</span>(.x, <span class="st">"Age</span><span class="sc">\\</span><span class="st">s|</span><span class="sc">\\</span><span class="st">syears"</span>)) <span class="sc">+</span> </span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"navy"</span>)) <span class="sc">+</span> </span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"2019 Census Bureau population estimate"</span>, </span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Population structure in Utah"</span>, </span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>, </span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data source: US Census Bureau population estimates &amp; tidycensus R package"</span>)</span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>utah_pyramid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :
font family not found in Windows font database</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database

Warning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font
family not found in Windows font database</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/pyramid4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The population pyramid is complete and ready to interpret!</p>
</section>
<section id="small-multiplesfaceted-plots" class="level2">
<h2 class="anchored" data-anchor-id="small-multiplesfaceted-plots">Small Multiples/Faceted Plots</h2>
<p>OUr next visualization is faceted plots, or small multiples–where the dataset is sub-divided into groups that are plotted side-by-side for comparison.</p>
<p>Below, we call data for a comparison of median home values by Census tract for 3 counties in the Portland, Oregon area: Multnomah, which contains the city of Portland, and the suburban counties of Clackamas and Washington.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>housing_val <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"tract"</span>, </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="st">"B25077_001"</span>, </span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"OR"</span>, </span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="fu">c</span>(</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Multnomah"</span>, </span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Clackamas"</span>, </span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Washington"</span>,</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Yamhill"</span>, </span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Marion"</span>, </span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Columbia"</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
</div>
<p>With the <code>NAME</code> column being extra long, we will be seperating them based on their commas using the <code>seperate()</code> function into three new columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>housing_val2 <span class="ot">&lt;-</span> <span class="fu">separate</span>(</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>  housing_val, </span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>  NAME, </span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"tract"</span>, <span class="st">"county"</span>, <span class="st">"state"</span>), </span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">", "</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we utilize the <code>group_by()</code> function to group the rows into their respective counties, followed by the <code>summarize()</code> function to calculate basic statistics–county minimums, means, medians, and maximums.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>housing_val2 <span class="sc">%&gt;%</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county) <span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">min =</span> <span class="fu">min</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean =</span> <span class="fu">mean</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">max</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  county               min    mean median     max
  &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1 Clackamas County   62800 449941. 426700  909000
2 Columbia County   218100 277591. 275900  362200
3 Marion County      48700 270969. 261200  483500
4 Multnomah County  192900 455706. 425950 1033500
5 Washington County 221900 419618. 406100  769700
6 Yamhill County    230000 333816. 291100  545500</code></pre>
</div>
</div>
<p>While examining these statistics on a table is sufficient, plotting them can prove more useful. Below, we create a kernel density plot to show the overall distribution of median home values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(housing_val2, <span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span> </span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/smol4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Then, we can add in the county variable and customize it as a fill (<code>fill =</code>) to place multiple plots on the same axis for each county.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(housing_val2, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">fill =</span> county)) <span class="sc">+</span> </span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/smol5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>An alternative to the multiple plots if you do not want the overlap is utilizing the <code>fecet_wrap()</code> function and splitting the visual to a side-by-side format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(housing_val2, <span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">"darkgreen"</span>, <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>county) <span class="sc">+</span> </span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">dollar_format</span>(<span class="at">scale =</span> <span class="fl">0.000001</span>, </span>
<span id="cb217-5"><a href="#cb217-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">suffix =</span> <span class="st">"m"</span>)) <span class="sc">+</span> </span>
<span id="cb217-6"><a href="#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span> </span>
<span id="cb217-7"><a href="#cb217-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb217-8"><a href="#cb217-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>)) <span class="sc">+</span> </span>
<span id="cb217-9"><a href="#cb217-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"ACS estimate"</span>,</span>
<span id="cb217-10"><a href="#cb217-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb217-11"><a href="#cb217-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Median home values by Census tract, 2015-2019 ACS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing non-finite values (`stat_density()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/smol6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These group-wise plots can be further customized and shifted around, but it provides a great baseline for analysis!</p>
</section>
<section id="advanced-visualizations" class="level2">
<h2 class="anchored" data-anchor-id="advanced-visualizations">Advanced Visualizations</h2>
<p>This final section highlights other gg packages/extensions associated with the <code>ggplot2</code> package for more advanced visualizations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install these packages below once</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggridges")</span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("ggbeeswarm")</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("geofacet")</span></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("plotly")</span></span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges) <span class="co">#ridgeline plots</span></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm) <span class="co">#categorical scatter/violin point plots</span></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geofacet) <span class="co">#faceting utilities for geographic data</span></span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="co">#advanced application to interactive web graphics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
</div>
<p>The <strong>ggridges</strong> package generates ridgeline plots similar to the faceted density plot, where the densities and distirbutions can overlap to look seamless and conserve space.</p>
<p>Below we use the <code>geom_density_ridges()</code> function on Portland-area home value data to plot the ridgeline, customizing the ridgeline styles using the <code>theme_ridges()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(housing_val2, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> county)) <span class="sc">+</span> </span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_ridges</span>() <span class="sc">+</span> </span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ridges</span>() <span class="sc">+</span> </span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Median home value: 2016-2020 ACS estimate"</span>, </span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span> </span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>(<span class="at">scale =</span> .<span class="dv">000001</span>, <span class="at">suffix =</span> <span class="st">"m"</span>),</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>, <span class="dv">1000000</span>)) <span class="sc">+</span> </span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 36200</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing non-finite values (`stat_density_ridges()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/ggridges-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The <strong>ggbeeswarm</strong> package generates beeswarm plots, which contain clouds of points jittered about to show the overall density of a distribution of values.</p>
<p>Below, we call data for household income by race/ethnicity in New York City, filtering and combining data in order to examine the distributions of median household income by the racial and ethnic composition of neighborhoods. We use the <code>geom_quasirandom()</code> function to create this plot, with a series of coordinate flipping and style customization to create the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>ny_race_income <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"tract"</span>, </span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="st">"NY"</span>,  </span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">county =</span> <span class="fu">c</span>(<span class="st">"New York"</span>, <span class="st">"Bronx"</span>, <span class="st">"Queens"</span>, <span class="st">"Richmond"</span>, <span class="st">"Kings"</span>),</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">variables =</span> <span class="fu">c</span>(<span class="at">White =</span> <span class="st">"B03002_003"</span>, </span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Black =</span> <span class="st">"B03002_004"</span>, </span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">Asian =</span> <span class="st">"B03002_006"</span>,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">Hispanic =</span> <span class="st">"B03002_012"</span>), </span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">summary_var =</span> <span class="st">"B19013_001"</span>,</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2020</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(GEOID) <span class="sc">%&gt;%</span></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(estimate <span class="sc">==</span> <span class="fu">max</span>(estimate, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Getting data from the 2016-2020 5-year ACS</code></pre>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ny_race_income, <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> summary_est, <span class="at">color =</span> summary_est)) <span class="sc">+</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quasirandom</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">13</span>) <span class="sc">+</span> </span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span> </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span> </span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Largest group in Census tract"</span>, </span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Median household income"</span>, </span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Household income distribution by largest racial/ethnic group"</span>, </span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Census tracts, New York City"</span>, </span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data source: 2016-2020 ACS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 35 rows containing missing values (`position_quasirandom()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/ggbeeswarm-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The <strong>geofacet</strong> package generates enhanced versions of faceted plots that arrange subplots in relationship to their relative geographic location, typcially taking the shape of their representative georeferenced landforms.</p>
<p>Below, we call the population pyramid from the <strong>Population Pyramids</strong> section for each state in the U.S., but we filter the population information to reflect the proportion of the overall population for each state for consistency. We use the <code>geom_col()</code> function to create the individual pyramids, but utilize the <code>facet_geo</code> function to establish each pyramid on a georefereneced grid of the U.S. (<code>us_state_with_DC_PR_grid2</code>). We also eliminate the axis information as it will be displayed too small for readability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>us_pyramid_data <span class="ot">&lt;-</span> <span class="fu">get_estimates</span>(</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">geography =</span> <span class="st">"state"</span>,</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">product =</span> <span class="st">"characteristics"</span>,</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">breakdown =</span> <span class="fu">c</span>(<span class="st">"SEX"</span>, <span class="st">"AGEGROUP"</span>),</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">breakdown_labels =</span> <span class="cn">TRUE</span>,</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="dv">2019</span></span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(AGEGROUP, <span class="st">"^Age"</span>),</span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a>         SEX <span class="sc">!=</span> <span class="st">"Both sexes"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb231-10"><a href="#cb231-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(NAME) <span class="sc">%&gt;%</span></span>
<span id="cb231-11"><a href="#cb231-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> value <span class="sc">/</span> <span class="fu">sum</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb231-12"><a href="#cb231-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb231-13"><a href="#cb231-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">ifelse</span>(SEX <span class="sc">==</span> <span class="st">"Male"</span>, <span class="sc">-</span>prop, prop))</span>
<span id="cb231-14"><a href="#cb231-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-15"><a href="#cb231-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(us_pyramid_data, <span class="fu">aes</span>(<span class="at">x =</span> prop, <span class="at">y =</span> AGEGROUP, <span class="at">fill =</span> SEX)) <span class="sc">+</span> </span>
<span id="cb231-16"><a href="#cb231-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb231-17"><a href="#cb231-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb231-18"><a href="#cb231-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"navy"</span>)) <span class="sc">+</span> </span>
<span id="cb231-19"><a href="#cb231-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_geo</span>(<span class="sc">~</span>NAME, <span class="at">grid =</span> <span class="st">"us_state_with_DC_PR_grid2"</span>,</span>
<span id="cb231-20"><a href="#cb231-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="st">"code"</span>) <span class="sc">+</span> </span>
<span id="cb231-21"><a href="#cb231-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb231-22"><a href="#cb231-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span> </span>
<span id="cb231-23"><a href="#cb231-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb231-24"><a href="#cb231-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">""</span>, </span>
<span id="cb231-25"><a href="#cb231-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Population structure by age and sex"</span>, </span>
<span id="cb231-26"><a href="#cb231-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">""</span>, </span>
<span id="cb231-27"><a href="#cb231-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data source: US Census Bureau population estimates &amp; tidycensus R package"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lab2_quarto_files/figure-html/geofaceted-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If you are unhappy about the grid distribution, the <code>grid_design()</code> function pulls up an interactive app where you can design your own grid for use in geofaceted plots.</p>
<p>Lastly, the <code>plotly</code> package is one of many connectors between JavaScript libraries and the R language for the creation of interactive web-based data visualization.</p>
<p>Below, the <code>ggplotly()</code> function will convert an existing ggplot2 graphic we made in the <strong>Population Pyramids</strong> section into an interactive web visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(utah_pyramid)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-82d2146808f326378a76" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-82d2146808f326378a76">{"x":{"data":[{"orientation":"v","width":[120743,126108,130045,124535,128846,122197,108654,113907,104121,86950,75046,78972,75578,64309,49913,35411,23039,22667],"base":[0.52500000000000002,1.5249999999999999,2.5249999999999999,3.5249999999999999,4.5250000000000004,5.5250000000000004,6.5250000000000004,7.5250000000000004,8.5250000000000004,9.5250000000000004,10.525,11.525,12.525,13.525,14.525,15.525,16.524999999999999,17.524999999999999],"x":[60371.5,63054,65022.5,62267.5,64423,61098.5,54327,56953.5,52060.5,43475,37523,39486,37789,32154.5,24956.5,17705.5,11519.5,11333.5],"y":[0.95000000000000007,0.95000000000000018,0.95000000000000018,0.94999999999999973,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.95000000000000107,0.95000000000000284,0.95000000000000284],"text":["value:  120743<br />AGEGROUP: Age 0 to 4 years<br />SEX: Female","value:  126108<br />AGEGROUP: Age 5 to 9 years<br />SEX: Female","value:  130045<br />AGEGROUP: Age 10 to 14 years<br />SEX: Female","value:  124535<br />AGEGROUP: Age 15 to 19 years<br />SEX: Female","value:  128846<br />AGEGROUP: Age 20 to 24 years<br />SEX: Female","value:  122197<br />AGEGROUP: Age 25 to 29 years<br />SEX: Female","value:  108654<br />AGEGROUP: Age 30 to 34 years<br />SEX: Female","value:  113907<br />AGEGROUP: Age 35 to 39 years<br />SEX: Female","value:  104121<br />AGEGROUP: Age 40 to 44 years<br />SEX: Female","value:   86950<br />AGEGROUP: Age 45 to 49 years<br />SEX: Female","value:   75046<br />AGEGROUP: Age 50 to 54 years<br />SEX: Female","value:   78972<br />AGEGROUP: Age 55 to 59 years<br />SEX: Female","value:   75578<br />AGEGROUP: Age 60 to 64 years<br />SEX: Female","value:   64309<br />AGEGROUP: Age 65 to 69 years<br />SEX: Female","value:   49913<br />AGEGROUP: Age 70 to 74 years<br />SEX: Female","value:   35411<br />AGEGROUP: Age 75 to 79 years<br />SEX: Female","value:   23039<br />AGEGROUP: Age 80 to 84 years<br />SEX: Female","value:   22667<br />AGEGROUP: Age 85 years and older<br />SEX: Female"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(139,0,0,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Female","legendgroup":"Female","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[127060,132868,137940,129312,135806,129179,111776,117335,108090,89984,76450,76536,72048,59874,45370,30234,19148,15907],"base":[0.52500000000000002,1.5249999999999999,2.5249999999999999,3.5249999999999999,4.5250000000000004,5.5250000000000004,6.5250000000000004,7.5250000000000004,8.5250000000000004,9.5250000000000004,10.525,11.525,12.525,13.525,14.525,15.525,16.524999999999999,17.524999999999999],"x":[-63530,-66434,-68970,-64656,-67903,-64589.5,-55888,-58667.5,-54045,-44992,-38225,-38268,-36024,-29937,-22685,-15117,-9574,-7953.5],"y":[0.95000000000000007,0.95000000000000018,0.95000000000000018,0.94999999999999973,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.94999999999999929,0.95000000000000107,0.95000000000000284,0.95000000000000284],"text":["value: -127060<br />AGEGROUP: Age 0 to 4 years<br />SEX: Male","value: -132868<br />AGEGROUP: Age 5 to 9 years<br />SEX: Male","value: -137940<br />AGEGROUP: Age 10 to 14 years<br />SEX: Male","value: -129312<br />AGEGROUP: Age 15 to 19 years<br />SEX: Male","value: -135806<br />AGEGROUP: Age 20 to 24 years<br />SEX: Male","value: -129179<br />AGEGROUP: Age 25 to 29 years<br />SEX: Male","value: -111776<br />AGEGROUP: Age 30 to 34 years<br />SEX: Male","value: -117335<br />AGEGROUP: Age 35 to 39 years<br />SEX: Male","value: -108090<br />AGEGROUP: Age 40 to 44 years<br />SEX: Male","value:  -89984<br />AGEGROUP: Age 45 to 49 years<br />SEX: Male","value:  -76450<br />AGEGROUP: Age 50 to 54 years<br />SEX: Male","value:  -76536<br />AGEGROUP: Age 55 to 59 years<br />SEX: Male","value:  -72048<br />AGEGROUP: Age 60 to 64 years<br />SEX: Male","value:  -59874<br />AGEGROUP: Age 65 to 69 years<br />SEX: Male","value:  -45370<br />AGEGROUP: Age 70 to 74 years<br />SEX: Male","value:  -30234<br />AGEGROUP: Age 75 to 79 years<br />SEX: Male","value:  -19148<br />AGEGROUP: Age 80 to 84 years<br />SEX: Male","value:  -15907<br />AGEGROUP: Age 85 years and older<br />SEX: Male"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,0,128,0.75)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"Male","legendgroup":"Male","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.286425902864259,"r":7.9701120797011216,"b":27.895392278953928,"l":104.40846824408473},"font":{"color":"rgba(0,0,0,1)","family":"Verdana","size":15.940224159402243},"title":{"text":"Population structure in Utah","font":{"color":"rgba(0,0,0,1)","family":"Verdana","size":19.128268991282692},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-154000,154000],"tickmode":"array","ticktext":["150k","100k","50k","0k","50k","100k","150k"],"tickvals":[-150000,-100000,-50000,0,50000,100000,150000],"categoryorder":"array","categoryarray":["150k","100k","50k","0k","50k","100k","150k"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Verdana","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"Verdana","size":15.940224159402243}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,18.600000000000001],"tickmode":"array","ticktext":["0 to 4","5 to 9","10 to 14","15 to 19","20 to 24","25 to 29","30 to 34","35 to 39","40 to 44","45 to 49","50 to 54","55 to 59","60 to 64","65 to 69","70 to 74","75 to 79","80 to 84","85 and older"],"tickvals":[1,2,3,4,5,5.9999999999999991,7,8,9,10,11,12,13,14,15,16,17,18],"categoryorder":"array","categoryarray":["0 to 4","5 to 9","10 to 14","15 to 19","20 to 24","25 to 29","30 to 34","35 to 39","40 to 44","45 to 49","50 to 54","55 to 59","60 to 64","65 to 69","70 to 74","75 to 79","80 to 84","85 and older"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.9850560398505608,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Verdana","size":12.7521793275218},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.72455564360919278,"zeroline":false,"anchor":"x","title":{"text":"2019 Census Bureau population estimate","font":{"color":"rgba(0,0,0,1)","family":"Verdana","size":15.940224159402243}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Verdana","size":12.7521793275218},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"Verdana","size":15.940224159402243}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"c8a811b56997":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"c8a811b56997","visdat":{"c8a811b56997":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>While there are many advanced means of customization in this package, this is the simplest and most effective means for interactive visuals!</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>
